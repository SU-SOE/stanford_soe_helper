<?php
/**
 * @file
 * Code for the Stanford SoE Helper Sitewide feature.
 */

include_once 'stanford_soe_helper_sitewide.features.inc';

/**
 * Implements hook_block_info().
 */
function stanford_soe_helper_sitewide_block_info() {
  $blocks = array();
  $blocks['stanford_soe_intranet_link'] = array(
    'info' => t('Stanford SoE Intranet Link'),
  );

  return $blocks;
}

/**
 * Default settings wrapper for variable_get
 * @return [type] [description]
 */
function stanford_soe_helper_sitewide_get_settings() {
  $default_settings = array(
    'intranet_link_title' => t('Intranet'),
    'intranet_link_url' => 'https://insidesoe.stanford.edu/',
  );
  $settings = variable_get('stanford_soe_helper_sitewide_settings', $default_settings );

  return $settings;
}

/**
 * Implements hook_block_view().
 */
function stanford_soe_helper_sitewide_block_view($delta = '') {
  $block = array();

  switch($delta) {
    case 'stanford_soe_intranet_link' :
      $block['content'] = soe_helper_sitewide_link_block_view();
      break;
  }

  return $block;
}

/**
 * Callback for displaying the intranet link block.
 */
function soe_helper_sitewide_link_block_view() {
  $settings = stanford_soe_helper_sitewide_get_settings();
  $block = array(
    'intranet_link' => array(
      '#type' => 'markup',
      '#markup' => l($settings['intranet_link_title'],
        $settings['intranet_link_url'],
        array('attributes' => array('class' => 'private-link btn'))),
    ),
  );
  return $block;
}

